# 锻炼

每组开合跳 30s、深蹲 30s、弓箭步 30s、提膝下压 30s，中途休息一分钟左右，做 6 组。

# 学习 浏览器工作原理与实践

## 09 | 块级作用域：var 缺陷以及为什么要引入 let 和 const？

### 作用域（scope）

变量与函数的可访问范围，即作用域控制着变量和函数的可见性和生命周期。

ES6 之前，ES 的作用域只有两种：全局作用域和函数作用域

1. 全局作用域:对象在代码中的任何地方都能访问，命周期跟着页面的生命周期。

2. 函数作用域：函数内部定义的变量或者函数，且定义的变量或者函数只能在函数内部被访问。函数执行结束之后，函数内部定义的变量会被销毁。

### 变量提升所带来的问题

1. 变量容易在不被察觉的情况下被覆盖掉

2. 本应销毁的变量没有被销毁

### ES6 是如何解决变量提升带来的缺陷（块级作用域）

引入了 let 和 const 关键字。

## 10 | 作用域链和闭包 ：代码中出现相同的变量，JavaScript 引擎是如何选择的？

### 作用域链

当查找变量的时候，会先从当前上下文的变量对象中查找，如果没有找到，就会从父级(词法层面上的父级)执行上下文的变量对象中查找，一直找到全局上下文的变量对象，也就是全局对象。这样由多个执行上下文的变量对象构成的链表就叫做作用域链。

#### 词法作用域

程序源代码中定义变量的区域。

#### 块级作用域中的变量查找

![avatar](../image/kuaijizuoyongyu.png)

首先是在 bar 函数的执行上下文中查找，但因为 bar 函数的执行上下文中没有定义 test 变量，所以根据词法作用域的规则，下一步就在 bar 函数的外部作用域中查找，也就是全局作用域。

### 闭包

闭包：定义在一个函数内部的函数，将函数内部和函数外部连接起来。

#### 闭包是怎么回收的

如果引用闭包的函数是一个全局变量，那么闭包会一直存在直到页面关闭；但如果这个闭包以后不再使用的话，就会造成内存泄漏。

如果引用闭包的函数是个局部变量，等函数销毁后，在 JavaScript 引擎执行垃圾回收时，判断闭包这块内容如果已经不再被使用了，那么 JavaScript 引擎的垃圾回收器就会回收这块内存。
